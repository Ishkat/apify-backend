<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>
   Job Seeker Dashboard Mockup
  </title>

  <style>
  .heading-main {
    font-family: 'Playfair Display', serif;
    font-style: italic;
    font-size: 2rem;
    color: #fff;
    text-align: center;
  }
  .stroke-underline {
    text-decoration-line: underline;
    text-decoration-color: #d04848;
    text-decoration-thickness: 3px;
    text-underline-offset: 5px;
  }
</style>

<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Inter', sans-serif;
  }

  body {
    background-color: #1A1A1D;
    color: #FFF8F1;
    overflow-x: hidden;
  }

  /* Sidebar */
  .sidebar {
    position: fixed;
    top: 0;
    left: 0;
    width: 256px;
    height: 100vh;
    background-color: #1A1A1D;
    border-right: 1px solid rgba(255, 248, 241, 0.2);
    padding-top: 20px;
    transition: width 0.3s ease;
  }

  .sidebar.collapsed {
    width: 64px;
  }

  .sidebar .toggle-btn {
    display: flex;
    justify-content: flex-end;
    padding: 16px 24px 16px 16px; 
    cursor: pointer;
  }

  .sidebar .toggle-btn svg {
    width: 24px;
    height: 24px;
    stroke: #FFFFFF;
  }

  .sidebar nav a {
    display: flex;
    align-items: center;
    padding: 12px 24px;
    color: #FFFFFF;
    text-decoration: none;
    transition: background 0.3s ease;
    font-size: 20px;
  }

  .sidebar nav a:hover {
    background-color: rgba(255, 59, 48, 0.2);
  }

  .sidebar nav a svg {
    width: 24px;
    height: 24px;
    margin-right: 12px;
  }

  .sidebar.collapsed nav a span {
    display: none;
  }

  /* Header */
  .header {
    position: fixed;
    top: 0;
    left: 256px;
    right: 0;
    height: 64px;
    background-color: #1A1A1D;
    border-bottom: 1px solid rgba(255, 248, 241, 0.2);
    display: flex;
    align-items: center;
    padding: 0 24px;
    z-index: 10;
  }

  .header .search-bar {
    position: relative;
    width: 256px;
  }

  .header .search-bar svg {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    width: 20px;
    height: 20px;
    stroke: #FFFFFF;
  }

  .header .search-bar input {
    width: 100%;
    padding: 8px 16px 8px 40px;
    background-color: rgba(255, 248, 241, 0.1);
    border: 1px solid rgba(255, 248, 241, 0.2);
    border-radius: 8px;
    color: #FFF8F1;
    font-size: 14px;
  }

  .header .search-bar input::placeholder {
    color: rgba(255, 255, 255, 0.5);
  }

  .header .actions {
    margin-left: auto;
    display: flex;
    align-items: center;
    gap: 16px;
  }

  .header .actions button {
    padding: 8px;
    border-radius: 50%;
    background: none;
    border: none;
    cursor: pointer;
    transition: background 0.3s ease;
  }

  .header .actions button:hover {
    background-color: rgba(255, 59, 48, 0.2);
  }

  .header .actions button svg {
    width: 24px;
    height: 24px;
    stroke: #FFFFFF;
  }

  .header .actions .notification {
    position: relative;
  }

  .header .actions .notification .badge {
    position: absolute;
    top: -2px;
    right: -2px;
    width: 16px;
    height: 16px;
    background-color: #7A1C1C;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    color: #FFF8F1;
  }

  .header .actions .avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: 2px solid #FFFFFF;
    background-color: #FFFFFF;
    cursor: pointer;
  }

  /* Light Theme Fixes */
  body.light {
    background-color: #f9f9f9;
    color: #1A1A1D;
  }

  body.light .sidebar,
  body.light .header,
  body.light .job-card,
  body.light .welcome-banner,
  body.light .stat-card,
  body.light .job-entry,
  body.light .job-feed,
  body.light .application-section,
  body.light .job-entry-tag,
  body.light input,
  body.light select,
  body.light textarea {
    background-color: #ffffff !important;
    color: #1A1A1D !important;
    border-color: rgba(0, 0, 0, 0.1) !important;
  }

  body.light .stat-card h3,
  body.light .job-entry h3,
  body.light .job-entry p,
  body.light .welcome-banner h2,
  body.light .welcome-banner p {
    color: #1A1A1D !important;
  }

  body.light .apply-btn {
    background: linear-gradient(to right, #7A1C1C, #7A1C1C);
    color: #fff;
  }

  body.light .details-btn {
    border-color: #7A1C1C;
    color: #7A1C1C;
  }

  body.light .job-entry-tag {
    background-color: rgba(255, 59, 48, 0.1);
    color: #7A1C1C;
  }

  /* Main Content */
  .main-content {
    margin-left: 256px;
    padding: 88px 24px 24px;
  }

  .main-content.collapsed {
    margin-left: 64px;
  }

  /* Welcome Banner */
  .welcome-banner {
    background: rgba(255, 248, 241, 0.1);
    padding: 24px;
    border-radius: 12px;
    margin-top: 160px;
    margin-bottom: 24px;
  }

  .welcome-banner h1 {
    font-family: 'Poppins', sans-serif;
    font-size: 34px;
    font-weight: bold;
    margin-bottom: 16px;
    color: #FFF8F1;
  }

  .welcome-banner .stats {
    display: flex;
    gap: 16px;
  }

  .welcome-banner .stat-card {
    background: rgba(255, 248, 241, 0.1);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 248, 241, 0.2);
    border-radius: 12px;
    padding: 16px;
    text-align: center;
    flex: 1;
  }

  .welcome-banner .stat-card p {
    font-size: 18px;
    color: #FFF8F1;
  }

  .welcome-banner .stat-card p:last-child {
    font-size: 18px;
    font-weight: bold;
    color: #FFF8F1;
  }

  /* Job Feed */
  .job-feed h2 {
    font-family: 'Poppins', sans-serif;
    font-size: 20px;
    font-weight: bold;
    margin-bottom: 16px;
    color: #FFF8F1;
  }

  .job-card {
    background: rgba(255, 248, 241, 0.1);
    border: 1px solid rgba(255, 248, 241, 0.2);
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 16px;
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .job-card .job-details h3 {
    font-family: 'Poppins', sans-serif;
    font-size: 18px;
    font-weight: bold;
    color: #FFF8F1;
    margin-bottom: 4px;
  }

  .job-card .job-details p {
    font-size: 14px;
    color: #FFF8F1;
    margin-bottom: 8px;
  }

  .job-card .job-details .skills {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
  }

  .job-card .job-details .skills span {
    background-color: rgba(255, 59, 48, 0.2);
    color: #FFF8F1;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 12px;
  }

  .job-card .match-score {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    color: #7A1C1C;
  }

  .job-card .match-score svg {
    width: 16px;
    height: 16px;
    stroke: #7A1C1C;
  }

  .job-card .actions {
    display: flex;
    gap: 8px;
  }

  .job-card .actions button {
    padding: 8px 16px;
    border-radius: 8px;
    font-size: 14px;
    cursor: pointer;
    transition: background 0.3s ease;
  }

  .job-card .actions .apply-btn {
    background: linear-gradient(to right, #7A1C1C, #7A1C1C);
    color: #FFF8F1;
    border: none;
  }

  .job-card .actions .details-btn {
    background: none;
    border: 1px solid #7A1C1C;
    color: #7A1C1C;
  }

  /* New Job Entry Style */
  .job-entry {
    background: rgba(255, 248, 241, 0.1);
    border: 1px solid rgba(255, 248, 241, 0.2);
    border-radius: 12px;
    padding: 16px;
    margin-bottom: 16px;
  }

  .job-entry-title {
    font-family: 'Poppins', sans-serif;
    font-size: 18px;
    font-weight: bold;
    color: #FFF8F1;
    margin-bottom: 4px;
  }

  .job-entry-meta {
    display: flex;
    gap: 16px;
    margin-bottom: 8px;
    color: rgba(255, 248, 241, 0.7);
    font-size: 14px;
  }

  .job-entry-tags {
    display: flex;
    gap: 8px;
    margin-top: 8px;
  }

  .job-entry-tag {
    background-color: rgba(255, 59, 48, 0.2);
    color: #7A1C1C;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 12px;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .sidebar {
      width: 64px;
    }

    .sidebar nav a span {
      display: none;
    }

    .header {
      left: 64px;
    }

    .main-content {
      margin-left: 64px;
    }

    .header .search-bar {
      width: 200px;
    }

    .welcome-banner .stats {
      flex-direction: column;
    }

    .download-btn {
      background: #fff;
      color: #000;
      border: 1px solid #ccc;
      padding: 6px 16px;
      margin-right: 8px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
      transition: background 0.2s;
    }
    .download-btn:hover {
      background: #f4f4f4;
    }
	.applications-section .job-title, 
    .applications-section .job-type {
      color: #fff !important;
}
  }
</style>

 </head>
 <body>
  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
   <div class="toggle-btn" onclick="document.getElementById('sidebar').classList.toggle('collapsed'); document.getElementById('main-content').classList.toggle('collapsed');">
    <svg fill="none" stroke="currentColor" viewbox="0 0 24 24">
     <path d="M4 6h16M4 12h16M4 18h16" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
     </path>
    </svg>
   </div>
   <nav>
    <!-- Home -->
    <a href="#" onclick="showSection('home')">
     <svg fill="none" stroke="currentColor" viewbox="0 0 24 24">
      <path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
      </path>
     </svg>
     <span>
      Home
     </span>
    </a>
    <!-- Jobs Feed -->
    <a href="#" onclick="showSection('jobsfeed')">
     <svg fill="none" stroke="currentColor" viewbox="0 0 24 24">
      <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
      </path>
     </svg>
     <span>
      Jobs Feed
     </span>
    </a>
    <!-- Applications -->
    <!-- Update the Applications link in the sidebar -->
    <a href="#" onclick="showSection('applications')">
        <svg fill="none" stroke="currentColor" viewbox="0 0 24 24">
            <path d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
            </path>
        </svg>
        <span>
            Applications
        </span>
    </a>
    <!-- Analytics -->
    <a href="#" onclick="showSection('analytics')">
     <svg fill="none" stroke="currentColor" viewbox="0 0 24 24">
      <path d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
      </path>
     </svg>
     <span>
      Analytics
     </span>
    </a>
   </nav>
  </div>
  <!-- Header -->
  <div class="header">
   <div class="search-bar">
    <svg fill="none" stroke="currentColor" viewbox="0 0 24 24">
     <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
     </path>
    </svg>
    <input placeholder="Search jobs, candidates, or analytics" type="text"/>
   </div>
   <div class="actions">
    <!-- <button id="theme-toggle">
    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
    </svg>
    </button> -->

    <button class="notification">
     <svg fill="none" stroke="currentColor" viewbox="0 0 24 24">
      <path d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
      </path>
     </svg>
     <span class="badge">
      3
     </span>
    </button>
    <a href="/profile/{{ candidate_id }}?token=">
     <div class="avatar">
     </div>
    </a>
   </div>
  </div>
  <!-- Main Content -->
  <div class="main-content" id="main-content">
   <!-- Home Section -->
   <div id="home-section">

<div style="text-align: left; margin-left: 260px; margin-top: 20px; margin-bottom: -40px;">
  <p style="font-size: 45px; color: #FFF8F1; font-family: 'Poppins', sans-serif; font-weight: 300; margin-bottom: 0;">
    Someone‚Äôs hiring right now and
  </p>

  <div style="text-align: right; margin-right: 260px; margin-top: 20px;">
    <span style="font-size: 40px; font-family: 'Cormorant Garamond', serif; font-style: italic; color: #FFF8F1; position: relative; display: inline-block;">
      Jarvis already 
      <span style="position: relative; display: inline-block;">
        Applied for you.
        <!-- Red underline using SVG -->
        <svg viewBox="0 0 160 20" preserveAspectRatio="none" style="position: absolute; bottom: -4px; left: 0; width: 100%; height: 10px;">
          <path d="M2,15 C50,5 110,25 158,10" stroke="#7A1C1C" stroke-width="10" fill="none" stroke-linecap="round"/>
        </svg>
      </span>
    </span>
  </div>
</div>


    <!-- Welcome Banner -->
    <div class="welcome-banner" style="margin-top: 100px; font-size: 100px;">
     <h1>
      Welcome, {{ full_name }}!
     </h1>
     <div class="stats">
      <div class="stat-card">
       <p>
        Jobs Applied
       </p>
       <p>
       {{ jobs_applied }}
       </p>
      </div>
      <div class="stat-card">
       <p>
        Interviews
       </p>
       <p>
        -
       </p>
      </div>
      <div class="stat-card">
       <p>
        Selected
       </p>
       <p>
        -
       </p>
      </div>
     </div>
    </div>



    <!-- Add this inside the welcome-banner div, after the stats section -->
    <div style="text-align: center; margin-top: 30px;">
      <button id="jobjarvis-btn"
              onclick="toggleJobJarvis('{{ candidate_id }}')"
              style="padding: 24px 48px;
                    font-size: 26px;
                    background: linear-gradient(to right, #7A1C1C, #7A1C1C);
                    color: white;
                    border: none;
                    border-radius: 8px;
                    font-weight: bold;
                    cursor: pointer;">
        Activate JobJarvis
      </button>
    </div>

    
    <!-- Blank Section -->
    <div id="blank-section" style="display: none;">
     <div style="text-align: center; padding: 100px 20px; color: #FFF8F1;">
      <h2>
       üóÇ No content here yet
      </h2>
      <p>
       This page will soon contain dynamic job feed or application details.
      </p>
     </div>
    </div>
   </div>
 <div id="applications-section" style="display: none;">
    <div style="background-color: #1A1A1D; padding: 24px; border-radius: 12px;">
        <h2 style="font-size: 24px; font-weight: bold; color: #FFF8F1; margin-bottom: 16px;">
            Application Tracker
        </h2>
        <!-- Toolbar -->
        <div style="display: flex; justify-content: space-between; flex-wrap: wrap; margin-bottom: 16px; gap: 10px;">
            <div style="display: flex; gap: 8px;">
                <button id="downloadCSV" style="background: white; color: black; padding: 8px 16px; border-radius: 6px; margin-left: 8px; border: none; cursor: pointer;">
                  Download CSV
                </button>
                <button id="downloadExcel" style="background: white; color: black; padding: 8px 16px; border-radius: 6px; margin-left: 4px; border: none; cursor: pointer;">
                  Download Excel
                </button>
                <select id="dateDropdown" style="padding: 8px; border-radius: 6px; background-color: #1A1A1D; color: #FFF8F1; border: 1px solid #FFF8F1;">
                  <option value="30">Last 30 Days</option>
                  <option value="7">Last 7 Days</option>
                  <option value="9999">All Time</option>
                </select>

            </div>
            <input placeholder="Search applications..." style="padding: 8px 12px; border-radius: 6px; background-color: #1A1A1D; border: 1px solid #FFF8F1; color: #FFF8F1;" type="text"/>
        </div>
        <!-- Filters -->
        <div style="display: flex; gap: 12px; margin-bottom: 16px;">
            <button style="color: #FFF8F1; background-color: #1A1A1D; padding: 6px 12px; border-radius: 20px;">
                All <strong id="all-count">(0)</strong>
			</button>
			<button style="color: #FFF8F1; background-color: #1A1A1D; padding: 6px 12px; border-radius: 20px;">
			    Queued <span id="queued-count">(0)</span>
            </button>
            <button style="color: #FFF8F1; background-color: #1A1A1D; padding: 6px 12px; border-radius: 20px;">
                Applied <span id="applied-count">(0)</span>
            </button>
            <button style="color: #FFF8F1; background-color: #1A1A1D; padding: 6px 12px; border-radius: 20px;">
                Skipped <span id="skipped-count">(0)</span>
            </button>
            <button style="color: #FFF8F1; background-color: #1A1A1D; padding: 6px 12px; border-radius: 20px;">
                Selected <span id="selected-count">(0)</span>
            </button>
            <button style="color: #FFF8F1; background-color: #1A1A1D; padding: 6px 12px; border-radius: 20px;">
                Rejected <span id="rejected-count">(0)</span>
            </button>
        </div>
        <!-- Table -->
        <div style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse;">
                <thead style="background-color: #1A1A1D; color: #FFF8F1;">
                    <tr>
                        <th style="text-align: left; padding: 8px;">Job Title</th>
                        <th style="text-align: left; padding: 8px;">Job Location</th>
                        <th style="text-align: left; padding: 8px;">Company Name</th>
                        <th style="text-align: left; padding: 8px;">Date & Time</th>
                        <!-- <th style="text-align: left; padding: 8px;">ATS Score</th> -->
                        <th style="text-align: left; padding: 8px;">Comment</th>
                        <th style="text-align: left; padding: 8px;">Status</th>
                        <th style="text-align: left; padding: 8px;">Interview Status</th>
                        <th style="text-align: left; padding: 8px;">Final Verdict</th>
                    </tr>
                </thead>
                <tbody id="applications-table-body" style="color: #FFF8F1;">
                    <!-- Applications will be dynamically inserted here -->
                </tbody>
            </table>
        </div>
    </div>
</div>
<!-- Jobs Feed Section -->
<div id="jobsfeed-section" style="display: none;">
    <div style="display: flex; flex-direction: row; gap: 24px; align-items: flex-start;">
        <!-- Filters Panel -->
        <aside style="width: 300px; background-color: #1A1A1D; padding: 20px; border-radius: 12px; border: 1px solid rgba(255,248,241,0.1);">
            <h3 style="color: #FFF8F1; margin-bottom: 12px;">
                Filters
            </h3>
            <div style="margin-bottom: 16px;">
                <input placeholder="Job title or company" style="width: 100%; padding: 10px; background: #1A1A1D; border: 1px solid #FFF8F1; border-radius: 8px; color: #FFF8F1;" type="text"/>
            </div>
            <div style="margin-bottom: 16px;">
                <label>
                    Applications
                </label>
                <select class="border p-2 w-full" style="width: 100%; padding: 8px; border: 1px solid #FFF8F1; background-color: #1A1A1D; color: #FFF8F1; border-radius: 8px;">
                    <option value="all">All</option>
					 <option value="queued">Queued</option>
                    <option value="applied">Applied</option>
                    <option value="skipped">Skipped</option>
                    <option value="selected">Selected</option>
                    <option value="rejected">Rejected</option>
                </select>
            </div>
            <div style="margin-bottom: 16px;">
                <label style="display: block; margin-bottom: 4px; accent-color: #7A1C1C;">
                    Remote Only
                </label>
                <div>
                    <input type="checkbox" id="remote-only" class="mr-2" style="accent-color: #7A1C1C;">
                    <span>
                        Show remote jobs only
                    </span>
                </div>
            </div>
            <div>
                <label>
                    Sort By
                </label>
                <select class="border p-2 w-full" style="width: 100%; padding: 8px; border: 1px solid #FFF8F1; background-color: #1A1A1D; color: #FFF8F1; border-radius: 8px;">
                    <option value="recent">Most Recent</option>
                    <!-- <option value="applicants-low">Applicants (Low to High)</option>
                    <option value="applicants-high">Applicants (High to Low)</option> -->
                    <option value="relevance">Relevance</option>
                </select>
            </div>
        </aside>
        
        <!-- Job Cards Panel -->
        <section style="flex: 1; display: flex; flex-direction: column; gap: 16px;">
            <h2 style="color: #FFF8F1; font-family: 'Poppins', sans-serif; font-size: 20px; font-weight: bold;">
    		All Jobs (<span id="job-count">0</span>)
	    </h2>
	    <div id="jobs-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"
     		style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 16px;">
    		<!-- Jobs will be dynamically inserted here by fetchJobs() -->
	    </div>

        </section>
    </div>
</div>

<!-- Insert this section just before the closing </div> of main-content -->
<div id="analytics-section" style="display: none;">
  <div style="display: flex; flex-wrap: wrap; gap: 24px; background-color: #1A1A1D; border-radius: 12px; padding: 24px; border: 1px solid rgba(255,248,241,0.2);">

    <!-- Left: Weekly Goal Section -->
    <div style="flex: 1 1 350px; background: rgba(255,248,241,0.1); padding: 24px; border-radius: 12px; border: 1px solid rgba(255,248,241,0.2); display: flex; flex-direction: column; justify-content: space-between;">
      <div>
        <!-- <h2 style="font-family: 'Poppins', sans-serif; font-size: 20px; font-weight: bold; color: #FFF8F1; margin-bottom: 16px;">
          Week of <span id="week-range"></span>
        </h2> -->
        <div style="display: flex; align-items: center; gap: 16px;">

<div style="display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; margin-top: 40px;">
  <svg width="160" height="90" viewBox="0 0 120 60">
    <!-- Background Arc -->
    <path d="M10,60 A50,50 0 0,1 110,60"
          fill="none"
          stroke="#3E3E3E"
          stroke-width="12"
          stroke-linecap="round" />
    <!-- Foreground Arc (Full red arc) -->
    <path d="M10,60 A50,50 0 0,1 110,60"
          fill="none"
          stroke="#7A1C1C"
          stroke-width="12"
          stroke-linecap="round"
          stroke-dasharray="157.08"
          stroke-dashoffset="0" />
  </svg>

  <!-- <p style="margin-top: 8px; font-size: 18px; color: #FFF8F1; font-weight: bold;">0</p>
  <p style="font-size: 14px; color: #FFF8F1;">jobs applied</p> -->
</div>

          <div>
            <p style="font-size: 14px; color: #FFF8F1; margin: 0;"></p>
            <p style="font-size: 28px; color: #FFF8F1; font-family: 'Cormorant Garamond', serif; font-style: italic; max-width: 90%; margin-top: 60px;">
              Stay active, stay visible your next job could be just one application away.
            </p>
          </div>
        </div>
      </div>
      <div style="margin-top: 20px; display: flex; align-items: center; gap: 12px;">
        <!-- <span style="font-size: 14px; color: #FFF8F1;">Weekly goal: N/A</span> -->
        <!-- <button style="background-color: #7A1C1C; color: white; padding: 8px 16px; border-radius: 8px; border: none; cursor: pointer; margin-left: 18px;">
          Weekly Applied
        </button> -->

      </div>
    </div>

    <!-- Right: Tracker Overview Section -->
    <div style="flex: 1 1 350px; background: rgba(255,248,241,0.1); padding: 24px; border-radius: 12px; border: 1px solid rgba(255,248,241,0.2);">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
        <h2 style="font-family: 'Poppins', sans-serif; font-size: 20px; font-weight: bold; color: #FFF8F1;">Tracker Overview</h2>
        <select style="padding: 6px; background-color: #1A1A1D; color: #FFF8F1; border: 1px solid #FFF8F1; border-radius: 6px;">
          <option>This week</option>
          <option>This month</option>
          <option>Today</option>
        </select>
      </div>
      <div style="font-size: 14px; color: #FFF8F1; display: flex; flex-direction: column; gap: 12px;">
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div><span>üìÑ Applications this week</span></div>
          <div><strong id="app-count">{{ applied_count }}</strong></div>
        </div>
        <div style="display: flex; align-items: center; justify-content: space-between;">
          <div><span>üí¨ Interviews this week</span></div>
          <div><strong id="interview-count">0</strong></div>
        </div>
        <!-- <div style="display: flex; align-items: center; justify-content: space-between;">
          <div><span>‚ù§Ô∏è Saved jobs this week</span></div>
          <div><strong id="saved-count">0</strong></div>
        </div> -->
        <div style="margin-top: 16px;">
          <button onclick="showSection('applications')" style="background-color: #7A1C1C; color: white; padding: 8px 16px; border-radius: 8px; border: none; cursor: pointer; margin-top: 12px;">
            Go to tracker
          </button>
        </div>
      </div>

    </div>
  </div>
</div>

<script>

  // Add this with your other JavaScript functions
    function activateJobJarvis(candidateId) {
      fetch('/activate-job-jarvis/' + candidateId + '?token=', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' }
      })
      .then(response => response.json())
      .then(data => {
        alert(data.message);
        if (data.success) {
          // Refresh the page or update UI as needed
          location.reload();
        }
      })
      .catch(error => {
        console.error('Error:', error);
        alert('Failed to activate JobJarvis. Please try again.');
      });
    }

    function loadAnalytics() {
      const today = new Date();
      const start = new Date(today);
      start.setDate(today.getDate() - today.getDay());
      const end = new Date(start);
      end.setDate(start.getDate() + 6);

      const formatDate = date => `${date.getMonth()+1}/${date.getDate()}/${date.getFullYear()}`;
      document.getElementById('week-range').textContent = `${formatDate(start)} - ${formatDate(end)}`;

      fetch('/get-analytics?token=')
        .then(res => res.json())
        .then(data => {
          document.getElementById('weekly-applications').textContent = data.weekly_applications || 0;
          document.getElementById('app-count').textContent = data.weekly_applications || 0;
          document.getElementById('interview-count').textContent = data.weekly_interviews || 0;
          document.getElementById('saved-count').textContent = data.weekly_saved || 0;
        })
        .catch(err => console.error('Analytics fetch error:', err));
    }

    // Fetch jobs from API and display in Jobs Feed and Applications
    // Fetch jobs from API and display in Jobs Feed and Applications
    async function fetchJobs(candidateId) {
        try {
            const response = await fetch(`/get-jobs?candidate_id=${candidateId}&token=`);
            const data = await response.json();
            if (data.status === 'success') {
                const jobs = data.jobs;
                const jobsContainer = document.getElementById('jobs-container');
                const applicationsTable = document.querySelector('#applications-section tbody');
                const jobCountElement = document.getElementById('job-count');
                
                // Update Jobs Feed
                jobsContainer.innerHTML = '';
                jobCountElement.textContent = jobs.length;
                
                jobs.forEach(job => {
                    const jobElement = document.createElement('div');
                    jobElement.className = 'job-card';
                    jobElement.innerHTML = `
                        <div class="job-details">
                            <h3>${job.title || 'No title available'}</h3>
                            <p>${job.company || 'No company specified'} ‚Ä¢ ${job.location || 'Location not specified'}</p>
                            <div class="skills">
                                <span>${job.type || 'Full-time'}</span>
                            </div>
                        </div>
                    `;
                    jobsContainer.appendChild(jobElement);
                });

                // Update Applications Table
                applicationsTable.innerHTML = '';
				jobs.forEach(job => {
				    const row = document.createElement('tr');
				    const status = job.status || 'Applied';  // fallback if null
				
				    row.innerHTML = `
				        <td>${job.title || 'No title available'}</td>
				        <td>${job.location || 'Location not specified'}</td>
				        <td>${job.company || 'No company specified'}</td>
				        <td>${job.created_at || 'Date not available'}</td>
				        <td>
				            <input placeholder="Write comment..." 
				                value="${job.comment || ''}" 
				                style="width: 100%; padding: 6px 8px; border-radius: 6px; background-color: #1A1A1D; border: 1px solid #FFF8F1; color: #FFF8F1;" 
				                type="text"
				            />
				        </td>
				        <td>
				            <select style="background-color: #1A1A1D; color: #FFF8F1; border: 1px solid #FFF8F1; border-radius: 6px; padding: 4px;">
				                <option value="Applied" ${status === 'Applied' ? 'selected' : ''}>Applied</option>
				                <option value="Selected" ${status === 'Selected' ? 'selected' : ''}>Selected</option>
				                <option value="Rejected" ${status === 'Rejected' ? 'selected' : ''}>Rejected</option>
				            </select>
				        </td>
				    `;
				    applicationsTable.appendChild(row);
				});

            } else {
                alert(data.message);
            }
        } catch (error) {
            console.error('Error fetching jobs:', error);
            alert('Failed to load jobs. Please try again.');
        }
    }


    // Activate JobJarvis
    let jobJarvisActive = false;

    async function toggleJobJarvis(candidateId) {
        const button = document.getElementById('jobjarvis-btn');
        const action = jobJarvisActive ? 'pause' : 'activate';

        try {
            const response = await fetch(`/${action}-job-jarvis/${candidateId}?token=`, {
                method: 'POST'
            });
            const data = await response.json();
            if (data.success) {
                jobJarvisActive = !jobJarvisActive;
                button.textContent = jobJarvisActive ? 'Pause JobJarvis' : 'Activate JobJarvis';
            } else {
                alert(data.message || `Failed to ${action} JobJarvis`);
            }
        } catch (error) {
            console.error(`${action} JobJarvis error:`, error);
            alert(`Failed to ${action} JobJarvis. Try again.`);
        }
    }


    function getCandidateIdFromURL() {
    const pathParts = window.location.pathname.split('/');
    return pathParts[pathParts.length - 1];
}


    // PASTE THE NEW fetchApplications() FUNCTION HERE
    // Add this function to fetch and display applications
    async function fetchApplications(candidateId) {
        try {
           // const candidateId = getCandidateIdFromURL();  // helper to extract candidate ID
            const response = await fetch(`/get-applications?candidate_id=${candidateId}&token=`);
            const data = await response.json();
            if (data.status === 'success') {
                const applications = data.applications;
                jobs = data.applications;
                const tableBody = document.getElementById('applications-table-body');
                
                // Update counts in the sidebar
                document.getElementById('all-count').textContent = `(${applications.length})`;
                
                // Count different statuses
                const statusCounts = {
					Queued: 0,
                    Applied: 0,
                    Skipped: 0,
                    Selected: 0,
                    Rejected: 0
                };
                
                applications.forEach(app => {
                    if (app.status) statusCounts[app.status]++;
                });
                
                            // ADD THIS LINE HERE
                // document.getElementById('sidebar-app-count').textContent = `${applications.length}`;
				
				
                document.getElementById('queued-count').textContent = `(${statusCounts.Queued})`;
                document.getElementById('applied-count').textContent = `(${statusCounts.Applied})`;
                document.getElementById('skipped-count').textContent = `(${statusCounts.Skipped})`;
                document.getElementById('selected-count').textContent = `(${statusCounts.Selected})`;
                document.getElementById('rejected-count').textContent = `(${statusCounts.Rejected})`;
                
                // Update applications table
                tableBody.innerHTML = '';
                applications.forEach(app => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td style="padding: 8px;">${app.title || 'No title available'}</td>
                        <td style="padding: 8px;">${app.location || 'Location not specified'}</td>
                        <td style="padding: 8px;">${app.company || 'No company specified'}</td>
                        <td style="padding: 8px;">${app.created_at || 'Date not available'}</td>
                       
                        <td style="padding: 8px;">
                            <input value="${app.comment || ''}" placeholder="Write comment..." style="width: 100%; padding: 6px 8px; border-radius: 6px; background-color: #1A1A1D; border: 1px solid #FFF8F1; color: #FFF8F1;" type="text"/>
                        </td>
                        <td style="padding: 8px;">
                            <select style="background-color: #1A1A1D; color: #FFF8F1; border: 1px solid #FFF8F1; border-radius: 6px; padding: 4px;">
								<option value="Applied" ${app.status?.toLowerCase() === 'applied' ? 'selected' : ''}>Applied</option>
								<option value="Queued" ${app.status?.toLowerCase() === 'queued' ? 'selected' : ''}>Queued</option>
								<option value="Skipped" ${app.status?.toLowerCase() === 'skipped' ? 'selected' : ''}>Skipped</option>
								<option value="Selected" ${app.status?.toLowerCase() === 'selected' ? 'selected' : ''}>Selected</option>
								<option value="Rejected" ${app.status?.toLowerCase() === 'rejected' ? 'selected' : ''}>Rejected</option>
                            </select>
                        </td>
                        <td style="padding: 8px;">
                            <select style="background-color: #1A1A1D; color: #FFF8F1; border: 1px solid #FFF8F1; border-radius: 6px; padding: 4px;">
                                <option value="" ${!app.interview_status ? 'selected' : ''}></option>
                                <option value="Test" ${app.interview_status === 'Test' ? 'selected' : ''}>Test</option>
                                <option value="Interview 1" ${app.interview_status === 'Interview 1' ? 'selected' : ''}>Interview 1</option>
                                <option value="Interview 2" ${app.interview_status === 'Interview 2' ? 'selected' : ''}>Interview 2</option>
                            </select>
                        </td>
                        <td style="padding: 8px;">
                            <select style="background-color: #1A1A1D; color: #FFF8F1; border: 1px solid #FFF8F1; border-radius: 6px; padding: 4px;">
                                <option value="" ${!app.final_verdict ? 'selected' : ''}></option>
                                <option value="Welcome Aboard" ${app.final_verdict === 'Welcome Aboard' ? 'selected' : ''}>üôå Welcome Aboard</option>
                                <option value="Not a Fit" ${app.final_verdict === 'Not a Fit' ? 'selected' : ''}>üíî Not a Fit</option>
                                <option value="Still Thinking" ${app.final_verdict === 'Still Thinking' ? 'selected' : ''}>ü§î Still Thinking</option>
                            </select>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
            } else {
                alert(data.message);
            }
        } catch (error) {
            console.error('Error fetching applications:', error);
            alert('Failed to load applications. Please try again.');
        }
    }

// Call immediately on load using candidate_id from Jinja
document.addEventListener("DOMContentLoaded", () => {
    fetchApplications("{{ candidate_id }}");
    fetchJobs("{{ candidate_id }}");
});
   
    // PASTE THE NEW showSection() FUNCTION HERE
    // Update the showSection function to call fetchApplications when applications section is shown
    function showSection(section) {
        const sections = ['home-section', 'blank-section', 'applications-section', 'analytics-section', 'jobsfeed-section'];
        sections.forEach(id => {
            const el = document.getElementById(id);
            if (el) el.style.display = 'none';
        });

        if (section === 'home') {
            document.getElementById('home-section').style.display = 'block';
        } else if (section === 'applications') {
            document.getElementById('applications-section').style.display = 'block';
            fetchApplications("{{ candidate_id }}"); // Changed from fetchJobs() to fetchApplications()
        } else if (section === 'analytics') {
            document.getElementById('analytics-section').style.display = 'block';
        } else if (section === 'jobsfeed') {
            document.getElementById('jobsfeed-section').style.display = 'block';
            fetchJobs("{{ candidate_id }}");
        } else {
            document.getElementById('blank-section').style.display = 'block';
        }
    }

    // Theme toggle (keep existing)
    document.addEventListener('DOMContentLoaded', () => {
        const toggleBtn = document.getElementById('theme-toggle');
        if (localStorage.getItem('theme') === 'light') {
            document.body.classList.add('light');
        }
        if (toggleBtn) {
            toggleBtn.addEventListener('click', () => {
                document.body.classList.toggle('light');
                const theme = document.body.classList.contains('light') ? 'light' : 'dark';
                localStorage.setItem('theme', theme);
            });
        }
    });
</script>

<script>
function getTableData() {
  const rows = document.querySelectorAll('#applications-table-body tr');
  const data = [];

  rows.forEach(row => {
    const cells = row.querySelectorAll('td');
    if (cells.length >= 8) {
      data.push({
        jobTitle: cells[0].innerText.trim(),
        jobLocation: cells[1].innerText.trim(),
        companyName: cells[2].innerText.trim(),
        dateTime: cells[3].innerText.trim(),
        comment: cells[4].querySelector('input')?.value || '',
        status: cells[5].querySelector('select')?.value || '',
        interviewStatus: cells[6].querySelector('select')?.value || '',
        finalVerdict: cells[7].querySelector('select')?.value || ''
      });
    }
  });

  return data;
}

function downloadCSV() {
  const data = getTableData();
  let csv = "Job Title,Job Location,Company Name,Date & Time,Comment,Status,Interview Status,Final Verdict\n";
  data.forEach(job => {
    csv += `"${job.jobTitle}","${job.jobLocation}","${job.companyName}","${job.dateTime}","${job.comment}","${job.status}","${job.interviewStatus}","${job.finalVerdict}"\n`;
  });
  const blob = new Blob([csv], { type: 'text/csv' });
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = 'application_tracker.csv';
  link.click();
}

function downloadExcel() {
  const data = getTableData();
  let excel = "Job Title\tJob Location\tCompany Name\tDate & Time\tComment\tStatus\tInterview Status\tFinal Verdict\n";
  data.forEach(job => {
    excel += `${job.jobTitle}\t${job.jobLocation}\t${job.companyName}\t${job.dateTime}\t${job.comment}\t${job.status}\t${job.interviewStatus}\t${job.finalVerdict}\n`;
  });
  const blob = new Blob([excel], { type: 'application/vnd.ms-excel' });
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = 'application_tracker.xls';
  link.click();
}

// Attach events
document.getElementById('downloadCSV').addEventListener('click', downloadCSV);
document.getElementById('downloadExcel').addEventListener('click', downloadExcel);

document.addEventListener("DOMContentLoaded", function () {
  fetch('/get-applications?token=')
    .then(response => response.json())
    .then(data => {
      if (data.status === "success") {
        const appliedCount = data.applications.filter(app => app.status?.toLowerCase() === "applied").length;
        const jobsAppliedElement = document.getElementById("jobsAppliedCount");
        if (jobsAppliedElement) {
          jobsAppliedElement.textContent = appliedCount;
        }
      }
    })
    .catch(error => console.error("Error fetching applications:", error));
});
</script>

<script>
document.addEventListener("DOMContentLoaded", async () => {
  try {
    const res = await fetch("/job-dashboard-data?token=");
    const data = await res.json();

    if (data.applied_count !== undefined) {
      document.getElementById("applied-count").textContent = data.applied_count;
    }
  } catch (err) {
    console.error("Error loading applied count:", err);
  }
});
</script>
